<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
title>Lissajous Loops — Shadow's Garden</title>
<meta name="description" content="Interactive Lissajous curve generator with harmonic motion visualization">
<link rel="stylesheet" href="../style.css">
<script src="../nav.js" defer></script>
<style>
  body {
    display: flex;
    flex-direction: column;
    align-items: center;
    background: #0a0a0f;
    min-height: 100vh;
    padding: 20px;
    box-sizing: border-box;
  }
  h1 {
    color: #e0e0e0;
    font-size: 1.8rem;
    margin-bottom: 5px;
    font-weight: 300;
  }
  .subtitle {
    color: #666;
    font-size: 0.9rem;
    margin-bottom: 20px;
  }
  canvas {
    border: 1px solid #222;
    border-radius: 4px;
    cursor: crosshair;
    box-shadow: 0 0 40px rgba(0,0,0,0.5);
  }
  .controls {
    display: flex;
    flex-wrap: wrap;
    gap: 20px;
    margin-top: 20px;
    justify-content: center;
    max-width: 800px;
  }
  .control-group {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 8px;
  }
  label {
    color: #888;
    font-size: 0.75rem;
    text-transform: uppercase;
    letter-spacing: 1px;
  }
  input[type="range"] {
    width: 120px;
    accent-color: #666;
  }
  .value-display {
    color: #aaa;
    font-size: 0.85rem;
    font-family: monospace;
  }
  select, button {
    background: #1a1a20;
    color: #ccc;
    border: 1px solid #333;
    padding: 8px 14px;
    border-radius: 4px;
    cursor: pointer;
    font-size: 0.85rem;
    transition: all 0.2s;
  }
  button:hover {
    background: #252530;
    border-color: #555;
  }
  .presets {
    display: flex;
    gap: 8px;
    flex-wrap: wrap;
    justify-content: center;
  }
  .preset-btn {
    background: #1a1a20;
    color: #888;
    border: 1px solid #333;
    padding: 6px 12px;
    border-radius: 4px;
    cursor: pointer;
    font-size: 0.75rem;
    transition: all 0.2s;
  }
  .preset-btn:hover {
    background: #252530;
    color: #ccc;
  }
  .info {
    color: #444;
    font-size: 0.7rem;
    margin-top: 15px;
    text-align: center;
    max-width: 500px;
    line-height: 1.5;
  }
</style>
</head>
<body data-page-type="app">
  <h1>Lissajous Loops</h1>
  <div class="subtitle">Harmonic motion at its finest • Drag to rotate • Scroll to zoom</div>
  <canvas id="canvas"></canvas>
  
  <div class="controls">
    <div class="control-group">
      <label>Frequency X</label>
      <input type="range" id="freqX" min="1" max="20" value="3">
      <span class="value-display" id="freqXVal">3</span>
    </div>
    <div class="control-group">
      <label>Frequency Y</label>
      <input type="range" id="freqY" min="1" max="20" value="2">
      <span class="value-display" id="freqYVal">2</span>
    </div>
    <div class="control-group">
      <label>Phase</label>
      <input type="range" id="phase" min="0" max="360" value="90">
      <span class="value-display" id="phaseVal">90°</span>
    </div>
    <div class="control-group">
      <label>Speed</label>
      <input type="range" id="speed" min="0.1" max="3" value="1" step="0.1">
      <span class="value-display" id="speedVal">1.0</span>
    </div>
    <div class="control-group">
      <label>Trails</label>
      <input type="range" id="trails" min="10" max="500" value="200">
      <span class="value-display" id="trailsVal">200</span>
    </div>
    <div class="control-group">
      <label>Actions</label>
      <button id="randomBtn">Random</button>
    </div>
  </div>
  
  <div class="controls" style="margin-top: 15px;">
    <div class="control-group">
      <label>Presets</label>
      <div class="presets">
        <button class="preset-btn" data-fx="1" data-fy="2">1:2</button>
        <button class="preset-btn" data-fx="2" data-fy="3">2:3</button>
        <button class="preset-btn" data-fx="3" data-fy="4">3:4</button>
        <button class="preset-btn" data-fx="3" data-fy="5">3:5</button>
        <button class="preset-btn" data-fx="5" data-fy="4">5:4</button>
        <button class="preset-btn" data-fx="5" data-fy="6">5:6</button>
        <button class="preset-btn" data-fx="7" data-fy="8">7:8</button>
        <button class="preset-btn" data-fx="1" data-fy="1">1:1</button>
      </div>
    </div>
  </div>

  <div class="info">
    Lissajous curves show the beauty of harmonic oscillation. The x and y axes oscillate at different frequencies, creating intricate patterns. When the ratio is rational, the curve closes. When irrational, it eventually fills the space.
  </div>

  <script>
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');
    
    let width, height;
    let freqX = 3;
    let freqY = 2;
    let phase = Math.PI / 2;
    let speed = 1;
    let trailLength = 200;
    let points = [];
    let time = 0;
    let rotation = 0;
    let zoom = 1;
    let isDragging = false;
    let lastMouse = { x: 0, y: 0 };
    
    function resize() {
      width = Math.min(700, window.innerWidth - 40);
      height = Math.min(700, window.innerHeight - 320);
      canvas.width = width;
      canvas.height = height;
    }
    
    function generateHslColor(t) {
      const hue = (t * 0.5) % 360;
      return `hsl(${hue}, 70%, 60%)`;
    }
    
    function draw() {
      const fadeAmount = Math.max(1, Math.floor(500 / trailLength));
      ctx.fillStyle = `rgba(10, 10, 15, ${fadeAmount / 50})`;
      ctx.fillRect(0, 0, width, height);
      
      const centerX = width / 2;
      const centerY = height / 2;
      const radius = Math.min(width, height) * 0.35 * zoom;
      
      // Draw the path
      if (points.length > 1) {
        ctx.beginPath();
        for (let i = 0; i < points.length - 1; i++) {
          const p1 = points[i];
          const p2 = points[i + 1];
          ctx.strokeStyle = p1.color;
          ctx.lineWidth = 2;
          ctx.beginPath();
          ctx.moveTo(p1.x, p1.y);
          ctx.lineTo(p2.x, p2.y);
          ctx.stroke();
        }
      }
      
      // Current point
      if (points.length > 0) {
        const p = points[points.length - 1];
        ctx.beginPath();
        ctx.arc(p.x, p.y, 6, 0, Math.PI * 2);
        ctx.fillStyle = '#fff';
        ctx.fill();
        
        // Glow
        ctx.beginPath();
        ctx.arc(p.x, p.y, 12, 0, Math.PI * 2);
        ctx.fillStyle = 'rgba(255,255,255,0.2)';
        ctx.fill();
      }
    }
    
    function update() {
      time += 0.02 * speed;
      
      const centerX = width / 2;
      const centerY = height / 2;
      const radius = Math.min(width, height) * 0.35 * zoom;
      
      const x = centerX + radius * Math.sin(freqX * time + rotation);
      const y = centerY + radius * Math.sin(freqY * time + phase + rotation);
      
      points.push({
        x, y,
        color: generateHslColor(time * 0.5)
      });
      
      if (points.length > trailLength) {
        points.shift();
      }
    }
    
    function animate() {
      update();
      draw();
      requestAnimationFrame(animate);
    }
    
    // Event listeners
    document.getElementById('freqX').addEventListener('input', (e) => {
      freqX = parseInt(e.target.value);
      document.getElementById('freqXVal').textContent = freqX;
      points = [];
    });
    
    document.getElementById('freqY').addEventListener('input', (e) => {
      freqY = parseInt(e.target.value);
      document.getElementById('freqYVal').textContent = freqY;
      points = [];
    });
    
    document.getElementById('phase').addEventListener('input', (e) => {
      const val = parseInt(e.target.value);
      phase = (val * Math.PI) / 180;
      document.getElementById('phaseVal').textContent = val + '°';
      points = [];
    });
    
    document.getElementById('speed').addEventListener('input', (e) => {
      speed = parseFloat(e.target.value);
      document.getElementById('speedVal').textContent = speed.toFixed(1);
    });
    
    document.getElementById('trails').addEventListener('input', (e) => {
      trailLength = parseInt(e.target.value);
      document.getElementById('trailsVal').textContent = trailLength;
    });
    
    document.getElementById('randomBtn').addEventListener('click', () => {
      freqX = Math.floor(Math.random() * 15) + 1;
      freqY = Math.floor(Math.random() * 15) + 1;
      phase = Math.random() * Math.PI * 2;
      speed = 0.5 + Math.random() * 2;
      
      document.getElementById('freqX').value = freqX;
      document.getElementById('freqY').value = freqY;
      document.getElementById('phase').value = Math.floor((phase * 180) / Math.PI);
      document.getElementById('speed').value = speed;
      
      document.getElementById('freqXVal').textContent = freqX;
      document.getElementById('freqYVal').textContent = freqY;
      document.getElementById('phaseVal').textContent = Math.floor((phase * 180) / Math.PI) + '°';
      document.getElementById('speedVal').textContent = speed.toFixed(1);
      
      points = [];
    });
    
    // Preset buttons
    document.querySelectorAll('.preset-btn').forEach(btn => {
      btn.addEventListener('click', () => {
        freqX = parseInt(btn.dataset.fx);
        freqY = parseInt(btn.dataset.fy);
        phase = Math.PI / 2;
        
        document.getElementById('freqX').value = freqX;
        document.getElementById('freqY').value = freqY;
        document.getElementById('phase').value = 90;
        
        document.getElementById('freqXVal').textContent = freqX;
        document.getElementById('freqYVal').textContent = freqY;
        document.getElementById('phaseVal').textContent = '90°';
        
        points = [];
      });
    });
    
    // Mouse controls
    canvas.addEventListener('mousedown', (e) => {
      isDragging = true;
      lastMouse = { x: e.clientX, y: e.clientY };
    });
    
    canvas.addEventListener('mousemove', (e) => {
      if (isDragging) {
        const dx = e.clientX - lastMouse.x;
        rotation += dx * 0.01;
        lastMouse = { x: e.clientX, y: e.clientY };
      }
    });
    
    canvas.addEventListener('mouseup', () => isDragging = false);
    canvas.addEventListener('mouseleave', () => isDragging = false);
    
    canvas.addEventListener('wheel', (e) => {
      e.preventDefault();
      zoom *= e.deltaY > 0 ? 0.95 : 1.05;
      zoom = Math.max(0.3, Math.min(2, zoom));
    });
    
    window.addEventListener('resize', resize);
    
    // Touch support
    canvas.addEventListener('touchstart', (e) => {
      isDragging = true;
      lastMouse = { x: e.touches[0].clientX, y: e.touches[0].clientY };
    });
    
    canvas.addEventListener('touchmove', (e) => {
      if (isDragging) {
        const dx = e.touches[0].clientX - lastMouse.x;
        rotation += dx * 0.01;
        lastMouse = { x: e.touches[0].clientX, y: e.touches[0].clientY };
      }
    });
    
    canvas.addEventListener('touchend', () => isDragging = false);
    
    // Init
    resize();
    animate();
  </script>
</body>
</html>
